# 病人資源關聯圖 - 功能說明

## 資源篩選動態更新功能

### 功能描述
當用戶在關聯圖中**點擊某個節點**時，右側的**資源篩選面板**會動態更新，只顯示與該節點相關的資源類型。

### 工作流程

#### 1. **選中節點前** 
- 篩選面板顯示所有可用的資源類型
- 常用資源類型預設勾選，其他資源類型不勾選
- 所有複選框都是**啟用狀態**，用戶可以自由選擇

#### 2. **選中節點時**
- 關聯圖會隱藏所有與該節點無關的節點和邊
- 右側**資源篩選面板**自動更新：
  - ✅ **只勾選**與該節點相關的資源類型
  - 🚫 **禁用**所有無關的資源類型（呈現灰色，無法點擊）
  - 用戶**只能看到該節點擁有的資源**進行篩選

#### 3. **取消選中節點時**
- 所有節點和邊恢復可見
- 篩選面板恢復原始狀態：
  - 常用資源預設勾選
  - 所有複選框重新啟用
  - 用戶可以再次自由選擇篩選條件

### 視覺反饋
- **禁用的篩選項目**：
  - 文字呈現灰色（降低透明度）
  - 複選框無法點擊（cursor: not-allowed）
  - 整個篩選項呈現為「不可用」狀態

### 使用場景
1. **快速查看特定資源**：點擊診斷節點，立即看到該診斷相關的觀察結果和其他資源
2. **簡化篩選**：自動過濾無關的資源類型，避免手動逐一取消勾選
3. **醫事人員工作流**：快速定位特定患者的特定醫療事件及其相關的所有資源

### 技術實現
- `updateFiltersForNode(nodeId, connectedNodeIds)`：當節點被選中時調用，更新篩選器顯示
- `restoreFullFilters()`：當節點被取消選中時調用，恢復完整的篩選選項
- 篩選複選框的 `disabled` 屬性控制是否可交互
- CSS 樣式提供視覺反饋

### 相關代碼位置
- [app.js - updateFiltersForNode](./app.js#L639)
- [app.js - restoreFullFilters](./app.js#L681)
- [app.js - selectNode 事件](./app.js#L798)
- [app.js - deselectNode 事件](./app.js#L851)
- [style.css - 篩選項禁用樣式](./style.css#L711)
